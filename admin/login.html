<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ù…Ø³Ø±Ø­ Ø§Ù„Ø¯Ù…Ù‰ STEM</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/auth.css">

    <style>
        .admin-login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 2rem;
        }

        .admin-login-box {
            background: white;
            border-radius: 20px;
            padding: 3rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 450px;
            width: 100%;
        }

        .admin-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .admin-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .admin-title {
            font-size: 1.8rem;
            font-weight: 900;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .admin-subtitle {
            color: #64748b;
            font-size: 0.95rem;
        }

        .quick-access {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1.5rem;
            text-align: center;
        }

        .quick-access p {
            margin: 0 0 0.5rem 0;
            font-size: 0.9rem;
            color: #475569;
        }

        .quick-links {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .quick-link {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 8px;
            text-decoration: none;
            color: #6366f1;
            font-weight: 600;
            font-size: 0.85rem;
            transition: all 0.3s;
        }

        .quick-link:hover {
            background: #6366f1;
            color: white;
            transform: translateY(-2px);
        }
    </style>
</head>

<body>
    <div class="admin-login-container">
        <div class="admin-login-box">
            <div class="admin-header">
                <div class="admin-icon">ğŸ”</div>
                <h1 class="admin-title">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h1>
                <p class="admin-subtitle">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯ÙŠØ±</p>
            </div>

            <form id="adminLoginForm">
                <div class="form-group">
                    <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                    <input type="email" id="email" required placeholder="admin@example.com" value="rami0407@gmail.com">
                </div>

                <div class="form-group">
                    <label for="password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="password" required placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                </div>

                <button type="submit" class="btn btn-primary btn-block">
                    ğŸš€ Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                </button>

                <div id="errorMessage" class="error-message" style="display: none;"></div>
            </form>

            <div class="quick-access">
                <p><strong>Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:</strong></p>
                <div class="quick-links">
                    <a href="dashboard.html" class="quick-link">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    <a href="users.html" class="quick-link">ğŸ‘¥ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</a>
                    <a href="puppet-management.html" class="quick-link">ğŸ­ Ø§Ù„Ø¯Ù…Ù‰</a>
                </div>
            </div>

            <div style="text-align: center; margin-top: 1.5rem;">
                <a href="../index.html" style="color: #64748b; text-decoration: none; font-size: 0.9rem;">
                    â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                </a>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>Ø¬Ø§Ø±Ù ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...</p>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Scripts -->
    <script src="../js/firebase-config.js"></script>

    <script>
        const form = document.getElementById('adminLoginForm');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const errorMessage = document.getElementById('errorMessage');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            loadingOverlay.style.display = 'flex';
            errorMessage.style.display = 'none';

            try {
                // Sign in with Firebase
                const userCredential = await firebase.auth().signInWithEmailAndPassword(email, password);
                const user = userCredential.user;

                // Check if user is admin
                const userDoc = await firebase.firestore().collection('users').doc(user.uid).get();

                if (!userDoc.exists) {
                    throw new Error('Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }

                const userData = userDoc.data();

                if (userData.role !== 'admin') {
                    // Not an admin
                    await firebase.auth().signOut();
                    throw new Error('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©. ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù…Ø¯ÙŠØ±Ø§Ù‹.');
                }

                // Success - redirect to admin dashboard
                window.location.href = 'dashboard.html';

            } catch (error) {
                console.error('Login error:', error);
                loadingOverlay.style.display = 'none';
                errorMessage.style.display = 'block';

                if (error.code === 'auth/user-not-found') {
                    errorMessage.textContent = 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± Ù…Ø³Ø¬Ù„';
                } else if (error.code === 'auth/wrong-password') {
                    errorMessage.textContent = 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage.textContent = 'ØµÙŠØºØ© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ­ÙŠØ­Ø©';
                } else {
                    errorMessage.textContent = error.message;
                }
            }
        });
    </script>
</body>

</html>