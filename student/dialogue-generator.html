<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๐ญ ูููุฏ ุงูุญูุงุฑุงุช ุญุณุจ ุดุฎุตูุชู</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/dialogue-generator.css">
</head>

<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <div class="logo">
                <span class="logo-icon">๐ญ</span>
                <span>ูุณุฑุญ ุงูุฏูู STEM</span>
            </div>
            <div class="nav-right">
                <span class="user-greeting">ูุฑุญุจุงู, <strong id="userName">ุงูุทุงูุจ</strong></span>
                <a href="#" id="backBtn" class="btn btn-outline btn-sm">ุงูุนูุฏุฉ</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="generator-container">
        <div class="generator-header">
            <h1>๐ญ ูููุฏ ุงูุญูุงุฑุงุช ุญุณุจ ุดุฎุตูุชู</h1>
            <p class="subtitle">ุงุญุตู ุนูู ุญูุงุฑ ูุณุฑุญู ูุงูู ูุฎุตุต ุจูุงุกู ุนูู ุดุฎุตูุชู ูุงูุชูุงูุงุชู - ุฌุงูุฒ ููุนุฑุถ ุนูู ูุณุฑุญ
                ุงูุฏูู!</p>
        </div>

        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-step active" data-step="1">
                <div class="step-circle">1</div>
                <div class="step-label">ูุนูููุงุช ุฃุณุงุณูุฉ</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="2">
                <div class="step-circle">2</div>
                <div class="step-label">ุชูุงุตูู ุงููุตุฉ</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="3">
                <div class="step-circle">3</div>
                <div class="step-label">ุงูุฅูุชุงุฌ</div>
            </div>
        </div>

        <!-- Form Steps -->
        <form id="assessmentForm" novalidate>
            <!-- Step 1: Basic Information -->
            <div class="form-step active" data-step="1">
                <div class="step-content">
                    <h2>๐ ูุนูููุงุช ุฃุณุงุณูุฉ</h2>
                    <p class="step-description">ุฃุฎุจุฑูุง ููููุงู ุนูู ููุตูุน ุญูุงุฑุงู ููุงุณุจุงู ููุณุชูุงู</p>

                    <div class="question-group">
                        <label class="question-label">ูุง ูู ุตูู ุงูุฏุฑุงุณูุ</label>
                        <select name="grade" class="select-input" required>
                            <option value="">ุงุฎุชุฑ ุงูุตู</option>
                            <option value="1">ุงูุตู ุงูุฃูู</option>
                            <option value="2">ุงูุตู ุงูุซุงูู</option>
                            <option value="3">ุงูุตู ุงูุซุงูุซ</option>
                            <option value="4">ุงูุตู ุงูุฑุงุจุน</option>
                            <option value="5">ุงูุตู ุงูุฎุงูุณ</option>
                            <option value="6">ุงูุตู ุงูุณุงุฏุณ</option>
                        </select>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ูุง ูู ุงูููุงุฏ ุงูููุถูุฉ ูุฏููุ (ุงุฎุชุฑ ุญุชู 3)</label>
                        <div class="checkbox-options">
                            <label class="checkbox-option">
                                <input type="checkbox" name="subjects" value="science">
                                <span>๐ฌ ุงูุนููู</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="subjects" value="math">
                                <span>๐ข ุงูุฑูุงุถูุงุช</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="subjects" value="arabic">
                                <span>๐ ุงููุบุฉ ุงูุนุฑุจูุฉ</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="subjects" value="art">
                                <span>๐จ ุงููููู</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="subjects" value="technology">
                                <span>๐ป ุงูุชูููููุฌูุง</span>
                            </label>
                            <label class="checkbox-option">
                                <input type="checkbox" name="subjects" value="social">
                                <span>๐ ุงูุนููู ุงูุงุฌุชูุงุนูุฉ</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Story Details -->
            <div class="form-step" data-step="2">
                <div class="step-content">
                    <h2>๐ญ ุชูุงุตูู ุงููุตุฉ</h2>
                    <p class="step-description">ุฃุฎุจุฑูุง ุนู ุงููุตุฉ ุงูุชู ุชุฑูุฏ ุฃู ูุฑูููุง ุงูุญูุงุฑ</p>

                    <div class="question-group">
                        <label class="question-label">ูุง ููุน ุงููุตุฉ ุงูุชู ุชุฑูุฏูุงุ</label>
                        <div class="story-types">
                            <label class="story-type">
                                <input type="radio" name="storyGenre" value="fantasy" required>
                                <div class="type-card">
                                    <span class="type-icon">๐</span>
                                    <span class="type-name">ุฎูุงููุฉ</span>
                                    <span class="type-desc">ุณุญุฑุ ูุฎูููุงุช ุฎุฑุงููุฉ</span>
                                </div>
                            </label>
                            <label class="story-type">
                                <input type="radio" name="storyGenre" value="realistic">
                                <div class="type-card">
                                    <span class="type-icon">๐</span>
                                    <span class="type-name">ูุงูุนูุฉ</span>
                                    <span class="type-desc">ุฃุญุฏุงุซ ููููุฉ</span>
                                </div>
                            </label>
                            <label class="story-type">
                                <input type="radio" name="storyGenre" value="adventure">
                                <div class="type-card">
                                    <span class="type-icon">๐บ๏ธ</span>
                                    <span class="type-name">ูุบุงูุฑุฉ</span>
                                    <span class="type-desc">ุฑุญูุงุชุ ุงุณุชูุดุงู</span>
                                </div>
                            </label>
                            <label class="story-type">
                                <input type="radio" name="storyGenre" value="educational">
                                <div class="type-card">
                                    <span class="type-icon">๐ฌ</span>
                                    <span class="type-name">ุชุนููููุฉ</span>
                                    <span class="type-desc">ูุนูููุงุช STEM</span>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ูุง ููุถูุน ุงููุตุฉุ</label>
                        <textarea name="storyTopic" rows="2" class="text-input"
                            placeholder="ูุซุงู: ุฑุญูุฉ ุฅูู ุงููุถุงุกุ ุตุฏุงูุฉ ุจูู ุญููุงูุงุชุ ุงุฎุชุฑุงุน ุฌุฏูุฏุ ุญู ูุบุฒ..."
                            required></textarea>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ูุง ุงููุดููุฉ ุฃู ุงูุชุญุฏู ูู ุงููุตุฉุ</label>
                        <textarea name="storyProblem" rows="2" class="text-input"
                            placeholder="ูุซุงู: ุถูุงุน ููุชุงุญ ุณุฑูุ ุฎูุงู ุจูู ุตุฏููููุ ูุบุฒ ูุญุชุงุฌ ุญูุ ูููุฉ ุตุนุจุฉ..."
                            required></textarea>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ูุง ุงููููุฉ ุฃู ุงูุฏุฑุณ ุงููุทููุจุ (ุงุฎุชูุงุฑู)</label>
                        <textarea name="storyValue" rows="2" class="text-input"
                            placeholder="ูุซุงู: ุงูุชุนุงููุ ุงูุตุฏูุ ุงูุดุฌุงุนุฉุ ุงููุซุงุจุฑุฉุ ุงูุงุญุชุฑุงู... (ูููู ุชุฑูู ูุงุฑุบุงู)"></textarea>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ููู ุชุฑูุฏ ุฃู ุชูุชูู ุงููุตุฉุ</label>
                        <div class="radio-options">
                            <label class="radio-option">
                                <input type="radio" name="endingType" value="happy" required>
                                <span>๐ ููุงูุฉ ุณุนูุฏุฉ</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="endingType" value="open">
                                <span>๐ค ููุงูุฉ ููุชูุญุฉ</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="endingType" value="lesson">
                                <span>๐ ููุงูุฉ ุชุนููููุฉ</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="endingType" value="surprise">
                                <span>๐ฎ ููุงูุฉ ููุงุฌุฆุฉ</span>
                            </label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ุฃูู ุชุฏูุฑ ุฃุญุฏุงุซ ุงููุตุฉุ</label>
                        <select name="location" class="select-input" id="locationSelect" required>
                            <option value="">ุงุฎุชุฑ ุงูููุงู</option>
                            <option value="forest">๐ณ ุบุงุจุฉ</option>
                            <option value="school">๐ซ ูุฏุฑุณุฉ</option>
                            <option value="space">๐ ุงููุถุงุก</option>
                            <option value="home">๐ ุงูุจูุช</option>
                            <option value="castle">๐ฐ ูุตุฑ/ููุนุฉ</option>
                            <option value="ocean">๐ ุงูุจุญุฑ/ุงูุดุงุทุฆ</option>
                            <option value="custom">โ๏ธ ููุงู ุขุฎุฑ (ุฃูุชุจู)</option>
                        </select>
                        <textarea name="customLocation" rows="1" class="text-input" id="customLocationInput"
                            style="display:none; margin-top:10px;" placeholder="ุงูุชุจ ุงูููุงู ุงูุฐู ุชุฑูุฏู..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Step 3: Puppet Selection -->
            <div class="form-step" data-step="3">
                <div class="step-content">
                    <h2>๐ญ ุงุฎุชูุงุฑ ุงูุฏูู</h2>
                    <p class="step-description">ุงุฎุชุฑ ุฏููุฉ ูุงุญุฏุฉ ุฃู ุฏููุชูู ูุญูุงุฑู ุงููุณุฑุญู</p>

                    <div class="puppet-selection-info">
                        <p>ุนุฏุฏ ุงูุฏูู ุงููุฎุชุงุฑุฉ: <strong id="selectedCount">0</strong> / 2</p>
                    </div>

                    <div class="puppet-gallery" id="puppetGallery">
                        <!-- Puppets will be loaded dynamically -->
                        <div class="loading-puppets">
                            <div class="spinner"></div>
                            <p>ุฌุงุฑู ุชุญููู ุงูุฏูู...</p>
                        </div>
                    </div>

                    <!-- Dialogue Settings in same step -->
                    <hr style="margin: 30px 0; border: none; border-top: 2px solid #f0f0f0;">

                    <h3 style="margin-top: 30px;">โ๏ธ ุฅุนุฏุงุฏุงุช ุงูุญูุงุฑ</h3>

                    <div class="question-group">
                        <label class="question-label">ุงุฎุชุฑ ูุบุฉ ุงูุญูุงุฑ</label>
                        <div class="language-options">
                            <label class="language-option">
                                <input type="radio" name="language" value="ar" required checked>
                                <span class="language-flag">๐ธ๐ฆ</span>
                                <span class="language-name">ุงูุนุฑุจูุฉ</span>
                            </label>
                            <label class="language-option">
                                <input type="radio" name="language" value="he">
                                <span class="language-flag">๐ฎ๐ฑ</span>
                                <span class="language-name">ืขืืจืืช</span>
                            </label>
                            <label class="language-option">
                                <input type="radio" name="language" value="en">
                                <span class="language-flag">๐ฌ๐ง</span>
                                <span class="language-name">English</span>
                            </label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">ุทูู ุงููุต ุงููุทููุจ</label>
                        <div class="radio-options-horizontal">
                            <label class="radio-option">
                                <input type="radio" name="length" value="short" required>
                                <span>๐ ูุตูุฑ (1-2 ุฏูููุฉ)</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="length" value="medium" checked>
                                <span>๐ ูุชูุณุท (3-5 ุฏูุงุฆู)</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="length" value="long">
                                <span>๐ ุทููู (5-10 ุฏูุงุฆู)</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="form-navigation">
                <button type="button" id="prevBtn" class="btn btn-outline" style="display: none;">ุงูุณุงุจู</button>
                <button type="button" id="nextBtn" class="btn btn-primary">ุงูุชุงูู</button>
                <button type="submit" id="generateBtn" class="btn btn-primary btn-lg" style="display: none;">
                    โจ ุชูููุฏ ุงูุญูุงุฑ
                </button>
            </div>
        </form>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-content">
            <div class="spinner"></div>
            <h3>ุฌุงุฑู ุฅูุดุงุก ุญูุงุฑู ุงููุฎุตุต...</h3>
            <p>ูุฏ ูุณุชุบุฑู ูุฐุง ุจุถุน ุซูุงูู</p>
        </div>
    </div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <!-- Scripts -->
    <script src="../js/firebase-config.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/gemini-service.js"></script> <!-- AI Service (Groq) -->
    <script src="../js/dialogue-generator.js?v=2.2"></script>
</body>

</html>